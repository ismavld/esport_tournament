<%- include('../partials/header', { page: 'tournaments', title: 'Tournois - E-Sport Tournaments' }) %>

      <div class="page-header">
        <h1>üèÜ Tournois</h1>
        <p>D√©couvrez et g√©rez tous les tournois e-sport disponibles</p>
      </div>

      <div class="card">
        <div class="card-title">üìã Liste des Tournois</div>
        <p>Les tournois seront charg√©s depuis l'API.</p>
        <div id="tournaments-list" style="margin-top: 20px;">
          <p style="color: #888;">Chargement des tournois...</p>
        </div>
      </div>

      <div class="card">
        <div class="card-title">‚ûï Cr√©er un Tournoi</div>
        <p style="margin-bottom: 20px;">Pour cr√©er un tournoi, vous devez √™tre connect√© en tant qu'organisateur.</p>
        <a href="/connexion" class="btn btn-primary">Se Connecter pour Cr√©er</a>
      </div>

      <script>
        async function loadTournaments() {
          try {
            const response = await fetch('/api/tournaments');
            let data = await response.json();
            
            const container = document.getElementById('tournaments-list');
            
            // Handle both array and object responses
            if (data && typeof data === 'object') {
              if (!Array.isArray(data)) {
                data = data.data || [];
              }
            }
            
            if (Array.isArray(data)) {
              if (data.length === 0) {
                container.innerHTML = '<p style="color: #888;">Aucun tournoi disponible pour le moment.</p>';
              } else {
                container.innerHTML = data.map(t => `
                  <div class="tournament-item" style="border: 1px solid #e5e7eb; padding: 12px; margin-bottom: 8px; border-radius: 6px;">
                    <strong>${t.name}</strong> - ${t.game} (${t.format})
                  </div>
                `).join('');
              }
            } else {
              container.innerHTML = '<p style="color: #f87171;">Aucun tournoi disponible pour le moment.</p>';
            }
          } catch (error) {
            console.error('Error:', error);
            document.getElementById('tournaments-list').innerHTML = '<p style="color: #f87171;">Erreur de connexion √† l\'API.</p>';
          }
        }

        loadTournaments();
      </script>

<%- include('../partials/footer') %>
