<%- include('../partials/header', { page: 'home', title: 'Accueil - E-Sport Tournaments' }) %>

      <div class="hero">
        <h1>üéÆ Bienvenue sur E-Sport Tournaments</h1>
        <p>Plateforme compl√®te de gestion de tournois e-sport</p>
        <div class="hero-buttons">
          <a href="/tournois" class="btn btn-primary">Voir les Tournois</a>
          <a href="/connexion" id="login-btn" class="btn btn-secondary">Se Connecter</a>
        </div>
      </div>

      <script>
        // Hide login button if already logged in
        function updateHeroButtons() {
          const token = localStorage.getItem('token');
          const loginBtn = document.getElementById('login-btn');
          if (token) {
            loginBtn.style.display = 'none';
          } else {
            loginBtn.style.display = 'inline-block';
          }
        }
        updateHeroButtons();
        window.addEventListener('storage', updateHeroButtons);
      </script>

      <div class="stats">
        <div class="stat-box">
          <div class="stat-number" id="stat-tournaments">0</div>
          <div class="stat-label">Tournois</div>
        </div>
        <div class="stat-box">
          <div class="stat-number" id="stat-teams">0</div>
          <div class="stat-label">√âquipes</div>
        </div>
        <div class="stat-box">
          <div class="stat-number" id="stat-players">0</div>
          <div class="stat-label">Joueurs</div>
        </div>
        <div class="stat-box">
          <div class="stat-number" id="stat-registrations">0</div>
          <div class="stat-label">Inscriptions</div>
        </div>
      </div>

      <div class="card">
        <div class="card-title">‚ÑπÔ∏è √Ä Propos</div>
        <p>
          Cette API REST g√®re compl√®tement les tournois e-sport avec authentification,
          gestion d'√©quipes, et syst√®me d'inscriptions.
        </p>
        <ul style="margin-top: 16px; margin-left: 20px; line-height: 1.8">
          <li><strong>Authentification JWT</strong> - S√©curis√©e avec bcrypt</li>
          <li><strong>Gestion de Tournois</strong> - CRUD complet + gestion de statut</li>
          <li><strong>√âquipes</strong> - Cr√©ation et modification avec autorisation</li>
          <li><strong>Inscriptions</strong> - Syst√®me flexible SOLO/TEAM</li>
          <li><strong>Statistiques</strong> - M√©triques d√©taill√©es par tournoi</li>
          <li><strong>Tests</strong> - Suite Vitest avec 23 tests</li>
        </ul>
      </div>

      <div class="card">
        <div class="card-title">üìö Documentation</div>
        <p>
          Consultez la <a href="/api-docs" target="_blank" style="color: #6366f1; text-decoration: underline;">documentation API compl√®te</a> 
          pour d√©couvrir tous les endpoints disponibles.
        </p>
      </div>

      <script>
        // Load stats on page load
        async function loadStats() {
          try {
            // Load tournaments count
            const tournamentsResponse = await fetch('/api/tournaments/public/all');
            const tournaments = await tournamentsResponse.json();
            const tournamentsCount = Array.isArray(tournaments) ? tournaments.length : 0;
            document.getElementById('stat-tournaments').textContent = tournamentsCount;

            // Load teams count
            const teamsResponse = await fetch('/api/teams/public/all');
            const teams = await teamsResponse.json();
            const teamsCount = Array.isArray(teams) ? teams.length : 0;
            document.getElementById('stat-teams').textContent = teamsCount;

            // Load users count
            const usersResponse = await fetch('/api/users');
            const users = await usersResponse.json();
            const usersCount = Array.isArray(users) ? users.length : 0;
            document.getElementById('stat-players').textContent = usersCount;

            // Load registrations count
            const statsResponse = await fetch('/api/stats');
            if (statsResponse.ok) {
              const stats = await statsResponse.json();
              document.getElementById('stat-registrations').textContent = stats.totalRegistrations || 0;
            }
          } catch (error) {
            console.error('Error loading stats:', error);
          }
        }
        loadStats();
        // Reload stats every 10 seconds
        setInterval(loadStats, 10000);
      </script>

<%- include('../partials/footer') %>
